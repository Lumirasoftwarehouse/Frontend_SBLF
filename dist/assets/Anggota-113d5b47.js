import{d as b,o as d,c as r,a,f as u,l as f,g as _,F as A,r as v,i as c,v as h,t as m}from"./index-e7b1fb08.js";import{S as y,N as w,F as U}from"./Footer-d3c57613.js";import{a as p}from"./axios-21b846bc.js";import{S as B}from"./sweetalert2.all-749d8cbc.js";import"./logo-42795f0e.js";const C={id:"wrapper"},S={id:"content-wrapper",class:"d-flex flex-column"},T={id:"content"},D={class:"container-fluid mt-4"},F=a("h1",{class:"h3 mb-0 text-gray-800 text-center"},"Anggota",-1),N={class:"row"},j=a("div",{class:"col-1"},null,-1),I={class:"col-10"},L=a("div",{class:"row mb-3"},[a("div",{class:"col-4"},[a("button",{class:"btn blueButton me-2","data-toggle":"modal","data-target":"#addAnggota"}," Tambahkan Anggota ")]),a("div",{class:"col-8"})],-1),O={class:"table-responsive"},V={key:0,class:"text-center"},z={key:1,class:"display table table-striped"},M=a("thead",null,[a("tr",null,[a("th",{scope:"col",style:{width:"50px"}},"No"),a("th",{scope:"col",style:{width:"130px"}},"Aksi"),a("th",{scope:"col"},"Image"),a("th",{scope:"col"},"Nama"),a("th",{scope:"col"},"Deskripsi")])],-1),x=["onClick"],K=a("i",{class:"bi bi-pencil-square"},null,-1),E=[K],H=["onClick"],J=a("i",{class:"bi bi-trash3-fill"},null,-1),q=[J],P=["src"],W=a("div",{class:"col-1"},null,-1),G={class:"modal fade",id:"addAnggota",tabindex:"-1",role:"dialog","aria-labelledby":"addAnggotaLabel","aria-hidden":"true"},Q={class:"modal-dialog",role:"document"},R={class:"modal-content"},X=a("div",{class:"modal-header"},[a("h5",{class:"modal-title",id:"addAnggotaLabel"},"Tambahkan Anggota"),a("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[a("span",{"aria-hidden":"true"},"×")])],-1),Y={class:"modal-body"},Z={class:"mb-3"},aa=a("label",{for:"image",class:"form-label"},"Image",-1),ta={class:"mb-3"},ea=a("label",{for:"nama",class:"form-label"},"Nama",-1),sa={class:"mb-3"},oa=a("label",{for:"deskripsi",class:"form-label"},"Deskripsi",-1),na={class:"modal-footer"},la=a("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1),ia={class:"modal",id:"updateAnggota",tabindex:"-1",role:"dialog","aria-labelledby":"updateAnggotaLabel","aria-hidden":"true"},da={class:"modal-dialog",role:"document"},ra={class:"modal-content"},ga=a("div",{class:"modal-header"},[a("h5",{class:"modal-title",id:"updateAnggotaLabel"},"Update Anggota"),a("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[a("span",{"aria-hidden":"true"},"×")])],-1),ca={class:"modal-body"},ha={class:"mb-3"},ma=a("label",{for:"image",class:"form-label"},"Image",-1),pa={class:"mb-3"},ua=a("label",{for:"nama",class:"form-label"},"Nama",-1),ba={class:"mb-3"},_a=a("label",{for:"deskripsi",class:"form-label"},"Deskripsi",-1),Aa={class:"modal-footer"},ka=a("button",{type:"button",class:"btn btn-danger","data-dismiss":"modal"}," Batal ",-1),fa={data(){return{newBenefit:"",dataAnggota:{image:null,judul:"",desripsi:""},dataUpdateAnggotas:{image:"",judul:"",desripsi:""},anggotas:[],dataBenefit:"",idTrend:"",user_id:"",ready:!1,remainingTime:"Loading"}},methods:{setDataAnggota(t,o,l,i){this.idTrend=t,this.dataUpdateAnggotas.nama=o,this.dataUpdateAnggotas.deskripsi=i,this.dataUpdateAnggotas.image=l},async updateAnggota(){try{const t=new FormData;t.append("image",this.dataAnggota.image),t.append("nama",this.dataUpdateAnggotas.nama),t.append("deskripsi",this.dataUpdateAnggotas.deskripsi);const o=await p.post(`https://backend-sblf.lumirainternational.com/api/auth/update-anggota/${this.idTrend}`,t,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log(o.data),this.updateAnggota="",this.fetchAnggota(),this.showAlert("Success","Anggota berhasil diupdate","success")}catch(t){console.error(t),this.showAlert("Oops...","Terjadi kesalahan saat mengupdate anggota","error")}},async tambahAnggota(){try{const t=new FormData;t.append("image",this.dataAnggota.image),t.append("nama",this.dataAnggota.nama),t.append("deskripsi",this.dataAnggota.deskripsi);const o=await p.post("https://backend-sblf.lumirainternational.com/api/auth/create-anggota",t,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log(o.data),this.dataAnggota={image:null,judul:""},this.dataAnggota.image=null,this.fetchAnggota(),this.showAlert("Berhasil!","Data anggota berhasil ditambahkan.","success")}catch(t){console.error(t),this.showAlert("Opps...","Terjadi kesalahan saat menambahkan data anggota.","error")}},async deleteAnggota(t){try{const o=await p.delete(`https://backend-sblf.lumirainternational.com/api/auth/delete-anggota/${t}`,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log(o.data),this.fetchAnggota(),this.showAlert("Success","Anggota berhasil didelete","success")}catch(o){console.error(o),this.showAlert("Oops...","Terjadi kesalahan saat mendelete anggota","error")}},async fetchAnggota(){this.ready=!1;try{const t=await p.get("https://backend-sblf.lumirainternational.com/api/auth/list-anggota",{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});this.anggotas=t.data.data,this.ready=!0}catch(t){console.error(t),this.showAlert("Opps...","Terjadi kesalahan saat mengambil data anggota.","error")}},showAlert(t,o,l){this.$swal({title:t,text:o,icon:l}).then(()=>{$("#addAnggota").modal("hide"),$("#updateAnggota").modal("hide")})},konfirmasi(t,o){B.fire({title:`Apakah Anda yakin ingin menghapus anggota ${o}?`,text:"Anggota akan dihapus jika anda menekan tombol Hapus.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#061387",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(l=>{l.isConfirmed&&this.deleteAnggota(t)})},handleFileUpload(t){this.dataAnggota.image=t.target.files[0]}},created(){const t=sessionStorage.getItem("token");if(t)try{const[o,l]=t.split("."),i=JSON.parse(atob(o)),s=atob(l),n=JSON.parse(atob(t.split(".")[1])),e=n.exp,g=new Date(e*1e3);console.log("Waktu Kedaluwarsa (UTC):",g.toUTCString()),new Date>g?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman"),this.user_id=n.id,console.log("ini idddd:",this.user_id),(!i||!s)&&this.$router.push("/"),this.fetchAnggota()}catch(o){console.error("Error decoding token:",o),this.$router.push("/")}else this.$router.push("/")}},Ca=Object.assign(fa,{__name:"Anggota",setup(t){const o=b(!1),l=b(""),i=()=>{o.value=!o.value,l.value=o.value?"toggle-sidebar":""};return(s,n)=>(d(),r(A,null,[a("div",C,[u(y,{class:f(l.value)},null,8,["class"]),a("div",S,[a("div",T,[u(w,{onToggleSidebar:i}),a("div",D,[F,a("div",N,[j,a("div",I,[L,a("div",O,[s.ready?_("",!0):(d(),r("p",V,"Loading...")),s.ready?(d(),r("table",z,[M,a("tbody",null,[(d(!0),r(A,null,v(s.anggotas,(e,g)=>(d(),r("tr",{key:e.id},[a("td",null,m(g+1),1),a("td",null,[a("button",{class:"btn btn-warning me-3","data-toggle":"modal","data-target":"#updateAnggota",onClick:k=>s.setDataAnggota(e.id,e.nama,e.image,e.deskripsi)},E,8,x),a("button",{class:"btn btn-danger",onClick:k=>s.konfirmasi(e.id,e.nama)},q,8,H)]),a("td",null,[a("img",{src:`https://backend-sblf.lumirainternational.com/storage/anggota/${e.image}`,alt:"trend",width:"200"},null,8,P)]),a("td",null,m(e.nama),1),a("td",null,m(e.deskripsi),1)]))),128))])])):_("",!0)])]),W])])]),u(U)])]),a("div",G,[a("div",Q,[a("div",R,[X,a("div",Y,[a("form",null,[a("div",Z,[aa,a("input",{type:"file",class:"form-control",id:"image",onChange:n[0]||(n[0]=(...e)=>s.handleFileUpload&&s.handleFileUpload(...e))},null,32)]),a("div",ta,[ea,c(a("input",{type:"text",class:"form-control",id:"nama","onUpdate:modelValue":n[1]||(n[1]=e=>s.dataAnggota.nama=e),placeholder:"Masukkan nama"},null,512),[[h,s.dataAnggota.nama]])]),a("div",sa,[oa,c(a("textarea",{class:"form-control","onUpdate:modelValue":n[2]||(n[2]=e=>s.dataAnggota.deskripsi=e),placeholder:"Masukkan deskripsi"},null,512),[[h,s.dataAnggota.deskripsi]])])])]),a("div",na,[la,a("button",{type:"button",class:"btn blueButton",onClick:n[3]||(n[3]=(...e)=>s.tambahAnggota&&s.tambahAnggota(...e))}," Kirim ")])])])]),a("div",ia,[a("div",da,[a("div",ra,[ga,a("div",ca,[a("form",null,[a("div",ha,[ma,a("input",{type:"file",class:"form-control",id:"image",onChange:n[4]||(n[4]=(...e)=>s.handleFileUpload&&s.handleFileUpload(...e))},null,32),a("p",null,m(s.dataUpdateAnggotas.image),1)]),a("div",pa,[ua,c(a("input",{type:"text",class:"form-control",id:"nama","onUpdate:modelValue":n[5]||(n[5]=e=>s.dataUpdateAnggotas.nama=e),placeholder:"Masukkan nama"},null,512),[[h,s.dataUpdateAnggotas.nama]])]),a("div",ba,[_a,c(a("textarea",{class:"form-control","onUpdate:modelValue":n[6]||(n[6]=e=>s.dataUpdateAnggotas.deskripsi=e),placeholder:"Masukkan deskripsi"},null,512),[[h,s.dataUpdateAnggotas.deskripsi]])])])]),a("div",Aa,[ka,a("button",{type:"button",class:"btn btn-primary",onClick:n[7]||(n[7]=(...e)=>s.updateAnggota&&s.updateAnggota(...e))}," Update ")])])])])],64))}});export{Ca as default};
