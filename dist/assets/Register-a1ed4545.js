import{d as m,o as r,c as n,a as e,f as h,u as b,g,F as _,r as f,l as y,v,t as d}from"./index-fa70ae61.js";import{S as k,N as w,F as R}from"./Footer-09c8d632.js";import{a as p}from"./axios-21b846bc.js";import{S as B}from"./sweetalert2.all-749d8cbc.js";import"./logo-42795f0e.js";const T={id:"wrapper"},S={id:"content-wrapper",class:"d-flex flex-column"},j={id:"content"},C={class:"container-fluid mt-4"},A=e("h1",{class:"h3 mb-3 text-gray-800 text-center"},"Data Register",-1),x={class:"row"},N=e("div",{class:"col-1"},null,-1),D={class:"col-10"},F={class:"table-responsive"},V={key:0,class:"text-center"},U={key:1,class:"display table table-striped"},I=e("thead",null,[e("tr",null,[e("th",{scope:"col",style:{width:"50px"}},"No"),e("th",{scope:"col"},"Fullname"),e("th",{scope:"col"},"Email"),e("th",{scope:"col"},"Nomor HP"),e("th",{scope:"col"},"Company Name")])],-1),O=e("div",{class:"col-1"},null,-1),L={class:"modal",id:"updateRegister",tabindex:"-1",role:"dialog","aria-labelledby":"updateRegisterLabel","aria-hidden":"true"},z={class:"modal-dialog",role:"document"},E={class:"modal-content"},H=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"updateRegisterLabel"},"Update Register"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"Ã—")])],-1),J={class:"modal-body"},K={class:"mb-3"},M=e("label",{for:"image",class:"form-label"},"Image",-1),P={class:"mb-3"},W=e("label",{for:"judul",class:"form-label"},"Judul",-1),q={class:"modal-footer"},G=e("button",{type:"button",class:"btn btn-danger","data-dismiss":"modal"}," Batal ",-1),Q={data(){return{newBenefit:"",dataValues:{image:null,judul:""},dataupdateRegisters:{image:null,judul:""},registers:[],dataBenefit:"",idTrend:"",user_id:"",ready:!1,remainingTime:"Loading"}},methods:{setDataTrend(t,s){this.idTrend=t,this.dataupdateRegisters.judul=s},async updateRegister(){try{const t=new FormData;t.append("image",this.dataValues.image),t.append("judul",this.dataupdateRegisters.judul);const s=await p.post(`https://backend-sblf.lumirainternational.com/api/auth/update-orientation/${this.idTrend}`,t,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log(s.data),this.updateRegister="",this.fetchRegisters(),this.showAlert("Success","Benefit berhasil diupdate","success")}catch(t){console.error(t),this.showAlert("Oops...","Terjadi kesalahan saat mengupdate benefit","error")}},async deleteTrend(t){try{const s=await p.delete(`https://backend-sblf.lumirainternational.com/api/auth/delete-orientation/${t}`,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log(s.data),this.fetchRegisters(),this.showAlert("Success","Benefit berhasil didelete","success")}catch(s){console.error(s),this.showAlert("Oops...","Terjadi kesalahan saat mendelete benefit","error")}},async fetchRegisters(){this.ready=!1;try{const t=await p.get("https://backend-sblf.lumirainternational.com/api/auth/list-register",{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});this.registers=t.data.data,this.ready=!0}catch(t){console.error(t),this.showAlert("Opps...","Terjadi kesalahan saat mengambil data benefit.","error")}},showAlert(t,s,l){this.$swal({title:t,text:s,icon:l}).then(()=>{$("#addValue").modal("hide"),$("#updateRegister").modal("hide")})},konfirmasi(t,s){B.fire({title:`Apakah Anda yakin ingin menghapus value ${s}?`,text:"Value akan dihapus jika anda menekan tombol Hapus.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#061387",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(l=>{l.isConfirmed&&this.deleteTrend(t)})},handleFileUpload(t){this.dataValues.image=t.target.files[0]}},created(){const t=sessionStorage.getItem("token");if(t)try{const[s,l]=t.split("."),u=JSON.parse(atob(s)),o=atob(l),i=JSON.parse(atob(t.split(".")[1])),a=i.exp,c=new Date(a*1e3);console.log("Waktu Kedaluwarsa (UTC):",c.toUTCString()),new Date>c?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman"),this.user_id=i.id,console.log("ini idddd:",this.user_id),(!u||!o)&&this.$router.push("/"),this.fetchRegisters()}catch(s){console.error("Error decoding token:",s),this.$router.push("/")}else this.$router.push("/")}},se=Object.assign(Q,{__name:"Register",setup(t){const s=m(!1),l=m(""),u=()=>{s.value=!s.value,l.value=s.value?"toggle-sidebar":""};return(o,i)=>(r(),n(_,null,[e("div",T,[h(k,{class:b(l.value)},null,8,["class"]),e("div",S,[e("div",j,[h(w,{onToggleSidebar:u}),e("div",C,[A,e("div",x,[N,e("div",D,[e("div",F,[o.ready?g("",!0):(r(),n("p",V,"Loading...")),o.ready?(r(),n("table",U,[I,e("tbody",null,[(r(!0),n(_,null,f(o.registers,(a,c)=>(r(),n("tr",{key:a.id},[e("td",null,d(c+1),1),e("td",null,d(a.fullname),1),e("td",null,d(a.email),1),e("td",null,d(a.num_phone),1),e("td",null,d(a.company),1)]))),128))])])):g("",!0)])]),O])])]),h(R)])]),e("div",L,[e("div",z,[e("div",E,[H,e("div",J,[e("form",null,[e("div",K,[M,e("input",{type:"file",class:"form-control",id:"image",onChange:i[0]||(i[0]=(...a)=>o.handleFileUpload&&o.handleFileUpload(...a))},null,32)]),e("div",P,[W,y(e("input",{type:"text",class:"form-control",id:"judul","onUpdate:modelValue":i[1]||(i[1]=a=>o.dataupdateRegisters.judul=a),placeholder:"Masukkan judul"},null,512),[[v,o.dataupdateRegisters.judul]])])])]),e("div",q,[G,e("button",{type:"button",class:"btn btn-primary",onClick:i[2]||(i[2]=(...a)=>o.updateRegister&&o.updateRegister(...a))}," Update ")])])])])],64))}});export{se as default};
