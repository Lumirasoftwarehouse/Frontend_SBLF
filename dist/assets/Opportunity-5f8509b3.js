import{d as b,o as r,c as d,a as t,f as m,u as f,g,F as _,r as O,l as u,v as c,t as y}from"./index-0b7282ca.js";import{S as v,N as w,F as j}from"./Footer-5a5cb758.js";import{a as h}from"./axios-21b846bc.js";import{S as B}from"./sweetalert2.all-749d8cbc.js";import"./logo-42795f0e.js";const C={id:"wrapper"},U={id:"content-wrapper",class:"d-flex flex-column"},S={id:"content"},A={class:"container-fluid mt-4"},D=t("h1",{class:"h3 mb-0 text-gray-800 text-center"},"Opportunity",-1),T={class:"row"},F=t("div",{class:"col-1"},null,-1),L={class:"col-10"},N=t("div",{class:"row mb-3"},[t("div",{class:"col-4"},[t("button",{class:"btn blueButton me-2","data-toggle":"modal","data-target":"#addOpportunity"}," Tambah Opportunity ")]),t("div",{class:"col-8"})],-1),V={class:"table-responsive"},I={key:0,class:"text-center"},z={key:1,class:"display table table-striped"},J=t("thead",null,[t("tr",null,[t("th",{scope:"col",style:{width:"50px"}},"No"),t("th",{scope:"col"},"Aksi"),t("th",{scope:"col"},"Gambar"),t("th",{scope:"col"},"Judul"),t("th",{scope:"col"},"Deskripsi")])],-1),x=["onClick"],G=t("i",{class:"bi bi-pencil-square"},null,-1),K=[G],M=["onClick"],E=t("i",{class:"bi bi-trash3-fill"},null,-1),H=[E],q=["src"],P=t("div",{class:"col-1"},null,-1),W={class:"modal fade",id:"addOpportunity",tabindex:"-1",role:"dialog","aria-labelledby":"addOpportunityLabel","aria-hidden":"true"},Q={class:"modal-dialog",role:"document"},R={class:"modal-content"},X=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"addOpportunityLabel"}," Tambah Opportunity "),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[t("span",{"aria-hidden":"true"},"×")])],-1),Y={class:"modal-body"},Z={class:"form-group"},tt=t("label",{for:"gambar"},"Gambar",-1),et={class:"form-group"},ot=t("label",{for:"judul"},"Judul",-1),at={class:"mb-3"},st=t("label",{for:"deskripsi",class:"form-label"},"Deskripsi",-1),it={class:"modal-footer"},nt=t("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1),lt={class:"modal fade",id:"updateOpportunity",tabindex:"-1",role:"dialog","aria-labelledby":"updateOpportunityLabel","aria-hidden":"true"},rt={class:"modal-dialog",role:"document"},dt={class:"modal-content"},pt=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"updateOpportunityLabel"}," Update Opportunity "),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[t("span",{"aria-hidden":"true"},"×")])],-1),ut={class:"modal-body"},ct={class:"form-group"},ht=t("label",{for:"gambar"},"Gambar",-1),mt={class:"form-group"},yt=t("label",{for:"judul"},"Judul",-1),bt={class:"mb-3"},gt=t("label",{for:"deskripsi",class:"form-label"},"Deskripsi",-1),_t={class:"modal-footer"},kt=t("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1),ft={data(){return{opportunityList:[],dataOpportunity:{image:null,judul:"",deskripsi:""},updateOpportunity:{image:null,judul:"",deskripsi:"",idOpportunity:""},user_id:"",ready:!1,remainingTime:"Loading"}},methods:{setDataUpdate(e,s,n,l){this.updateOpportunity.idOpportunity=e,this.updateOpportunity.image=s,this.updateOpportunity.judul=n,this.updateOpportunity.deskripsi=l},async sendUpdateOpportunity(){try{const e=new FormData;e.append("image",this.dataOpportunity.image),e.append("judul",this.updateOpportunity.judul),e.append("deskripsi",this.updateOpportunity.deskripsi);const s=await h.post(`https://backend-sblf.lumirainternational.com/api/auth/update-opportunity/${this.updateOpportunity.idOpportunity}`,e,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log(s.data),this.updateOpportunity={image:null,judul:"",deskripsi:"",idOpportunity:""},this.fetchOpportunity(),this.showAlert("Berhasil!","Data opportunity berhasil diupdate.","success")}catch(e){console.error(e),this.showAlert("Opps...","Terjadi kesalahan saat mengupdate data opportunity.","error")}},async tambahOpportunity(){try{const e=new FormData;e.append("image",this.dataOpportunity.image),e.append("judul",this.dataOpportunity.judul),e.append("deskripsi",this.dataOpportunity.deskripsi);const s=await h.post("https://backend-sblf.lumirainternational.com/api/auth/create-opportunity",e,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log(s.data),this.dataOpportunity={image:null,judul:"",deskripsi:""},this.fetchOpportunity(),this.showAlert("Berhasil!","Data opportunity berhasil ditambahkan.","success")}catch(e){console.error(e),this.showAlert("Opps...","Terjadi kesalahan saat menambahkan data opportunity.","error")}},async fetchOpportunity(){this.ready=!1;try{const e=await h.get("https://backend-sblf.lumirainternational.com/api/auth/get-opportunity",{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});this.opportunityList=e.data.data,this.ready=!0}catch(e){console.error(e),this.showAlert("Opps...","Terjadi kesalahan saat mengambil data opportunity.","error")}},showAlert(e,s,n){this.$swal({title:e,text:s,icon:n}).then(()=>{$("#addOpportunity").modal("hide"),$("#updateOpportunity").modal("hide")})},handleFileUpload(e){this.dataOpportunity.image=e.target.files[0]},async deleteOpportunity(e){try{const s=await h.delete(`https://backend-sblf.lumirainternational.com/api/auth/delete-opportunity/${e}`,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log(s.data),this.fetchOpportunity(),this.showAlert("Success","Opportunity berhasil didelete","success")}catch(s){console.error(s),this.showAlert("Oops...","Terjadi kesalahan saat mendelete opportunity","error")}},konfirmasi(e,s){B.fire({title:`Apakah Anda yakin ingin menghapus opportunity ${s}?`,text:"Benegit akan dihapus jika anda menekan tombol Hapus.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#061387",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(n=>{n.isConfirmed&&this.deleteOpportunity(e)})}},created(){const e=sessionStorage.getItem("token");if(e)try{const[s,n]=e.split("."),l=JSON.parse(atob(s)),a=atob(n),i=JSON.parse(atob(e.split(".")[1])),o=i.exp,p=new Date(o*1e3);console.log("Waktu Kedaluwarsa (UTC):",p.toUTCString()),new Date>p?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman"),this.user_id=i.id,console.log("ini idddd:",this.user_id),(!l||!a)&&this.$router.push("/"),this.fetchOpportunity()}catch(s){console.error("Error decoding token:",s),this.$router.push("/")}else this.$router.push("/")}},Ct=Object.assign(ft,{__name:"Opportunity",setup(e){const s=b(!1),n=b(""),l=()=>{s.value=!s.value,n.value=s.value?"toggle-sidebar":""};return(a,i)=>(r(),d(_,null,[t("div",C,[m(v,{class:f(n.value)},null,8,["class"]),t("div",U,[t("div",S,[m(w,{onToggleSidebar:l}),t("div",A,[D,t("div",T,[F,t("div",L,[N,t("div",V,[a.ready?g("",!0):(r(),d("p",I,"Loading...")),a.ready?(r(),d("table",z,[J,t("tbody",null,[(r(!0),d(_,null,O(a.opportunityList,(o,p)=>(r(),d("tr",{key:o.id},[t("td",null,y(p+1),1),t("td",null,[t("button",{class:"btn btn-warning me-3","data-toggle":"modal","data-target":"#updateOpportunity",onClick:k=>a.setDataUpdate(o.id,o.image,o.judul,o.deskripsi)},K,8,x),t("button",{class:"btn btn-danger",onClick:k=>a.konfirmasi(o.id,o.judul)},H,8,M)]),t("td",null,[t("img",{src:`https://backend-sblf.lumirainternational.com/storage/images/${o.image}`,alt:"opportunity",width:"200"},null,8,q)]),t("td",null,y(o.judul),1),t("td",null,y(o.deskripsi),1)]))),128))])])):g("",!0)])]),P])])]),m(j)])]),t("div",W,[t("div",Q,[t("div",R,[X,t("div",Y,[t("form",null,[t("div",Z,[tt,t("input",{type:"file",class:"form-control",id:"gambar",onChange:i[0]||(i[0]=(...o)=>a.handleFileUpload&&a.handleFileUpload(...o))},null,32)]),t("div",et,[ot,u(t("input",{type:"text",class:"form-control",id:"judul","onUpdate:modelValue":i[1]||(i[1]=o=>a.dataOpportunity.judul=o)},null,512),[[c,a.dataOpportunity.judul]])]),t("div",at,[st,u(t("textarea",{class:"form-control","onUpdate:modelValue":i[2]||(i[2]=o=>a.dataOpportunity.deskripsi=o),placeholder:"Masukkan deskripsi"},null,512),[[c,a.dataOpportunity.deskripsi]])])])]),t("div",it,[nt,t("button",{type:"button",class:"btn blueButton",onClick:i[3]||(i[3]=(...o)=>a.tambahOpportunity&&a.tambahOpportunity(...o))}," Kirim ")])])])]),t("div",lt,[t("div",rt,[t("div",dt,[pt,t("div",ut,[t("form",null,[t("div",ct,[ht,t("input",{type:"file",class:"form-control",id:"gambar",onChange:i[4]||(i[4]=(...o)=>a.handleFileUpload&&a.handleFileUpload(...o))},null,32)]),t("div",mt,[yt,u(t("input",{type:"text",class:"form-control",id:"judul","onUpdate:modelValue":i[5]||(i[5]=o=>a.updateOpportunity.judul=o)},null,512),[[c,a.updateOpportunity.judul]])]),t("div",bt,[gt,u(t("textarea",{class:"form-control","onUpdate:modelValue":i[6]||(i[6]=o=>a.updateOpportunity.deskripsi=o),placeholder:"Masukkan deskripsi"},null,512),[[c,a.updateOpportunity.deskripsi]])])])]),t("div",_t,[kt,t("button",{type:"button",class:"btn blueButton",onClick:i[7]||(i[7]=(...o)=>a.sendUpdateOpportunity&&a.sendUpdateOpportunity(...o))}," Update ")])])])])],64))}});export{Ct as default};
