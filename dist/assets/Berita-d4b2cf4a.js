import{d as g,o as d,c as n,a as t,f as m,u as f,g as _,F as B,r as y,l as c,v as p,t as b}from"./index-fd209f16.js";import{S as v,N as w,F as j}from"./Footer-237d52ff.js";import{a as h}from"./axios-21b846bc.js";import{S as C}from"./sweetalert2.all-749d8cbc.js";import"./logo-42795f0e.js";const U={id:"wrapper"},S={id:"content-wrapper",class:"d-flex flex-column"},A={id:"content"},D={class:"container-fluid mt-4"},O=t("h1",{class:"h3 mb-0 text-gray-800 text-center"},"Berita",-1),T={class:"row"},F=t("div",{class:"col-1"},null,-1),L={class:"col-10"},N=t("div",{class:"row mb-3"},[t("div",{class:"col-4"},[t("button",{class:"btn blueButton me-2","data-toggle":"modal","data-target":"#addBerita"}," Tambah Berita ")]),t("div",{class:"col-8"})],-1),V={class:"table-responsive"},I={key:0,class:"text-center"},z={key:1,class:"display table table-striped"},J=t("thead",null,[t("tr",null,[t("th",{scope:"col",style:{width:"50px"}},"No"),t("th",{scope:"col"},"Aksi"),t("th",{scope:"col"},"Gambar"),t("th",{scope:"col"},"Judul"),t("th",{scope:"col"},"Deskripsi")])],-1),x=["onClick"],G=t("i",{class:"bi bi-pencil-square"},null,-1),K=[G],M=["onClick"],E=t("i",{class:"bi bi-trash3-fill"},null,-1),H=[E],q=["src"],P=t("div",{class:"col-1"},null,-1),W={class:"modal fade",id:"addBerita",tabindex:"-1",role:"dialog","aria-labelledby":"addBeritaLabel","aria-hidden":"true"},Q={class:"modal-dialog",role:"document"},R={class:"modal-content"},X=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"addBeritaLabel"}," Tambah Opportunity "),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[t("span",{"aria-hidden":"true"},"×")])],-1),Y={class:"modal-body"},Z={class:"form-group"},tt=t("label",{for:"gambar"},"Gambar",-1),et={class:"form-group"},at=t("label",{for:"judul"},"Judul",-1),st={class:"mb-3"},ot=t("label",{for:"deskripsi",class:"form-label"},"Deskripsi",-1),it={class:"modal-footer"},lt=t("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1),rt={class:"modal fade",id:"updateBerita",tabindex:"-1",role:"dialog","aria-labelledby":"updateBeritaLabel","aria-hidden":"true"},dt={class:"modal-dialog",role:"document"},nt={class:"modal-content"},ut=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"updateBeritaLabel"}," Update Opportunity "),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[t("span",{"aria-hidden":"true"},"×")])],-1),ct={class:"modal-body"},pt={class:"form-group"},ht=t("label",{for:"gambar"},"Gambar",-1),mt={class:"form-group"},bt=t("label",{for:"judul"},"Judul",-1),gt={class:"mb-3"},_t=t("label",{for:"deskripsi",class:"form-label"},"Deskripsi",-1),Bt={class:"modal-footer"},kt=t("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1),ft={data(){return{beritaList:[],dataBerita:{image:null,judul:"",deskripsi:""},updateBerita:{image:null,judul:"",deskripsi:"",idBerita:""},user_id:"",ready:!1,remainingTime:"Loading"}},methods:{setDataUpdate(e,o,l,r){this.updateBerita.idBerita=e,this.updateBerita.image=o,this.updateBerita.judul=l,this.updateBerita.deskripsi=r},async sendUpdateBerita(){try{const e=new FormData;e.append("image",this.dataBerita.image),e.append("judul",this.updateBerita.judul),e.append("deskripsi",this.updateBerita.deskripsi);const o=await h.post(`https://backend-sblf.lumirainternational.com/api/auth/update-berita/${this.updateBerita.idBerita}`,e,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log(o.data),this.updateBerita={image:null,judul:"",deskripsi:"",idBerita:""},this.fetchBerita(),this.showAlert("Berhasil!","Data berita berhasil diupdate.","success")}catch(e){console.error(e),this.showAlert("Opps...","Terjadi kesalahan saat mengupdate data berita.","error")}},async tambahOpportunity(){try{const e=new FormData;e.append("image",this.dataBerita.image),e.append("judul",this.dataBerita.judul),e.append("deskripsi",this.dataBerita.deskripsi);const o=await h.post("https://backend-sblf.lumirainternational.com/api/auth/create-berita",e,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log(o.data),this.dataBerita={image:null,judul:"",deskripsi:""},this.fetchBerita(),this.showAlert("Berhasil!","Data berita berhasil ditambahkan.","success")}catch(e){console.error(e),this.showAlert("Opps...","Terjadi kesalahan saat menambahkan data berita.","error")}},async fetchBerita(){this.ready=!1;try{const e=await h.get("https://backend-sblf.lumirainternational.com/api/auth/get-berita",{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});this.beritaList=e.data.data,this.ready=!0}catch(e){console.error(e),this.showAlert("Opps...","Terjadi kesalahan saat mengambil data berita.","error")}},showAlert(e,o,l){this.$swal({title:e,text:o,icon:l}).then(()=>{$("#addBerita").modal("hide"),$("#updateBerita").modal("hide")})},handleFileUpload(e){this.dataBerita.image=e.target.files[0]},async deleteOpportunity(e){try{const o=await h.delete(`https://backend-sblf.lumirainternational.com/api/auth/delete-berita/${e}`,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log(o.data),this.fetchBerita(),this.showAlert("Success","Opportunity berhasil didelete","success")}catch(o){console.error(o),this.showAlert("Oops...","Terjadi kesalahan saat mendelete opportunity","error")}},konfirmasi(e,o){C.fire({title:`Apakah Anda yakin ingin menghapus opportunity ${o}?`,text:"Benegit akan dihapus jika anda menekan tombol Hapus.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#061387",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(l=>{l.isConfirmed&&this.deleteOpportunity(e)})}},created(){const e=sessionStorage.getItem("token");if(e)try{const[o,l]=e.split("."),r=JSON.parse(atob(o)),s=atob(l),i=JSON.parse(atob(e.split(".")[1])),a=i.exp,u=new Date(a*1e3);console.log("Waktu Kedaluwarsa (UTC):",u.toUTCString()),new Date>u?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman"),this.user_id=i.id,console.log("ini idddd:",this.user_id),(!r||!s)&&this.$router.push("/"),this.fetchBerita()}catch(o){console.error("Error decoding token:",o),this.$router.push("/")}else this.$router.push("/")}},Ut=Object.assign(ft,{__name:"Berita",setup(e){const o=g(!1),l=g(""),r=()=>{o.value=!o.value,l.value=o.value?"toggle-sidebar":""};return(s,i)=>(d(),n(B,null,[t("div",U,[m(v,{class:f(l.value)},null,8,["class"]),t("div",S,[t("div",A,[m(w,{onToggleSidebar:r}),t("div",D,[O,t("div",T,[F,t("div",L,[N,t("div",V,[s.ready?_("",!0):(d(),n("p",I,"Loading...")),s.ready?(d(),n("table",z,[J,t("tbody",null,[(d(!0),n(B,null,y(s.beritaList,(a,u)=>(d(),n("tr",{key:a.id},[t("td",null,b(u+1),1),t("td",null,[t("button",{class:"btn btn-warning me-3","data-toggle":"modal","data-target":"#updateBerita",onClick:k=>s.setDataUpdate(a.id,a.image,a.judul,a.deskripsi)},K,8,x),t("button",{class:"btn btn-danger",onClick:k=>s.konfirmasi(a.id,a.judul)},H,8,M)]),t("td",null,[t("img",{src:`https://backend-sblf.lumirainternational.com/storage/berita/${a.image}`,alt:"opportunity",width:"200"},null,8,q)]),t("td",null,b(a.judul),1),t("td",null,b(a.deskripsi),1)]))),128))])])):_("",!0)])]),P])])]),m(j)])]),t("div",W,[t("div",Q,[t("div",R,[X,t("div",Y,[t("form",null,[t("div",Z,[tt,t("input",{type:"file",class:"form-control",id:"gambar",onChange:i[0]||(i[0]=(...a)=>s.handleFileUpload&&s.handleFileUpload(...a))},null,32)]),t("div",et,[at,c(t("input",{type:"text",class:"form-control",id:"judul","onUpdate:modelValue":i[1]||(i[1]=a=>s.dataBerita.judul=a)},null,512),[[p,s.dataBerita.judul]])]),t("div",st,[ot,c(t("textarea",{class:"form-control","onUpdate:modelValue":i[2]||(i[2]=a=>s.dataBerita.deskripsi=a),placeholder:"Masukkan deskripsi"},null,512),[[p,s.dataBerita.deskripsi]])])])]),t("div",it,[lt,t("button",{type:"button",class:"btn blueButton",onClick:i[3]||(i[3]=(...a)=>s.tambahOpportunity&&s.tambahOpportunity(...a))}," Kirim ")])])])]),t("div",rt,[t("div",dt,[t("div",nt,[ut,t("div",ct,[t("form",null,[t("div",pt,[ht,t("input",{type:"file",class:"form-control",id:"gambar",onChange:i[4]||(i[4]=(...a)=>s.handleFileUpload&&s.handleFileUpload(...a))},null,32)]),t("div",mt,[bt,c(t("input",{type:"text",class:"form-control",id:"judul","onUpdate:modelValue":i[5]||(i[5]=a=>s.updateBerita.judul=a)},null,512),[[p,s.updateBerita.judul]])]),t("div",gt,[_t,c(t("textarea",{class:"form-control","onUpdate:modelValue":i[6]||(i[6]=a=>s.updateBerita.deskripsi=a),placeholder:"Masukkan deskripsi"},null,512),[[p,s.updateBerita.deskripsi]])])])]),t("div",Bt,[kt,t("button",{type:"button",class:"btn blueButton",onClick:i[7]||(i[7]=(...a)=>s.sendUpdateBerita&&s.sendUpdateBerita(...a))}," Update ")])])])])],64))}});export{Ut as default};
