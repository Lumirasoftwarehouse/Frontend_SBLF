import{d as m,o as l,c as r,a as e,f as h,u as k,g as p,F as b,r as v,l as g,v as _,t as T}from"./index-fd209f16.js";import{S as y,N as w,F as j}from"./Footer-237d52ff.js";import{a as c}from"./axios-21b846bc.js";import{S as B}from"./sweetalert2.all-749d8cbc.js";import"./logo-42795f0e.js";const C={id:"wrapper"},S={id:"content-wrapper",class:"d-flex flex-column"},A={id:"content"},U={class:"container-fluid mt-4"},D=e("h1",{class:"h3 mb-0 text-gray-800 text-center"},"Global Trends",-1),F={class:"row"},I=e("div",{class:"col-1"},null,-1),N={class:"col-10"},L=e("div",{class:"row mb-3"},[e("div",{class:"col-4"},[e("button",{class:"btn blueButton me-2","data-toggle":"modal","data-target":"#addTrend"}," Tambahkan Trend ")]),e("div",{class:"col-8"})],-1),O={class:"table-responsive"},x={key:0,class:"text-center"},z={key:1,class:"display table table-striped"},J=e("thead",null,[e("tr",null,[e("th",{scope:"col",style:{width:"50px"}},"No"),e("th",{scope:"col",style:{width:"130px"}},"Aksi"),e("th",{scope:"col"},"Image"),e("th",{scope:"col"},"Judul")])],-1),V=["onClick"],G=e("i",{class:"bi bi-pencil-square"},null,-1),K=[G],M=["onClick"],E=e("i",{class:"bi bi-trash3-fill"},null,-1),H=[E],q=["src"],P=e("div",{class:"col-1"},null,-1),W={class:"modal fade",id:"addTrend",tabindex:"-1",role:"dialog","aria-labelledby":"addTrendLabel","aria-hidden":"true"},Q={class:"modal-dialog",role:"document"},R={class:"modal-content"},X=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"addTrendLabel"},"Tambahkan Trend"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")])],-1),Y={class:"modal-body"},Z={class:"mb-3"},ee=e("label",{for:"image",class:"form-label"},"Image",-1),te={class:"mb-3"},ae=e("label",{for:"judul",class:"form-label"},"Judul",-1),se={class:"modal-footer"},oe=e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1),de={class:"modal",id:"updateTrend",tabindex:"-1",role:"dialog","aria-labelledby":"updateTrendLabel","aria-hidden":"true"},ne={class:"modal-dialog",role:"document"},le={class:"modal-content"},re=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"updateTrendLabel"},"Update Trend"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")])],-1),ie={class:"modal-body"},ce={class:"mb-3"},ue=e("label",{for:"image",class:"form-label"},"Image",-1),he={class:"mb-3"},me=e("label",{for:"judul",class:"form-label"},"Judul",-1),pe={class:"modal-footer"},be=e("button",{type:"button",class:"btn btn-danger","data-dismiss":"modal"}," Batal ",-1),ge={data(){return{newBenefit:"",dataTrends:{image:null,judul:""},dataUpdateTrends:{image:null,judul:""},globalTrends:[],dataBenefit:"",idTrend:"",user_id:"",ready:!1,remainingTime:"Loading"}},methods:{setDataTrend(t,a){this.idTrend=t,this.dataUpdateTrends.judul=a},async updateTrend(){try{const t=new FormData;t.append("image",this.dataTrends.image),t.append("judul",this.dataUpdateTrends.judul);const a=await c.post(`https://backend-sblf.lumirainternational.com/api/auth/update-trend/${this.idTrend}`,t,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log(a.data),this.updateTrend="",this.fetchTrends(),this.showAlert("Success","Trend berhasil diupdate","success")}catch(t){console.error(t),this.showAlert("Oops...","Terjadi kesalahan saat mengupdate trend","error")}},async tambahTrend(){try{const t=new FormData;t.append("image",this.dataTrends.image),t.append("judul",this.dataTrends.judul);const a=await c.post("https://backend-sblf.lumirainternational.com/api/auth/create-trend",t,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log(a.data),this.dataTrends={image:null,judul:""},this.dataTrends.image=null,this.fetchTrends(),this.showAlert("Berhasil!","Data trend berhasil ditambahkan.","success")}catch(t){console.error(t),this.showAlert("Opps...","Terjadi kesalahan saat menambahkan data trend.","error")}},async deleteTrend(t){try{const a=await c.delete(`https://backend-sblf.lumirainternational.com/api/auth/delete-trend/${t}`,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log(a.data),this.fetchTrends(),this.showAlert("Success","Trend berhasil didelete","success")}catch(a){console.error(a),this.showAlert("Oops...","Terjadi kesalahan saat mendelete trend","error")}},async fetchTrends(){this.ready=!1;try{const t=await c.get("https://backend-sblf.lumirainternational.com/api/auth/list-trend",{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});this.globalTrends=t.data.data,this.ready=!0}catch(t){console.error(t),this.showAlert("Opps...","Terjadi kesalahan saat mengambil data benefit.","error")}},showAlert(t,a,n){this.$swal({title:t,text:a,icon:n}).then(()=>{$("#addTrend").modal("hide"),$("#updateTrend").modal("hide")})},konfirmasi(t,a){B.fire({title:`Apakah Anda yakin ingin menghapus trend ${a}?`,text:"Trend akan dihapus jika anda menekan tombol Hapus.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#061387",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(n=>{n.isConfirmed&&this.deleteTrend(t)})},handleFileUpload(t){this.dataTrends.image=t.target.files[0]}},created(){const t=sessionStorage.getItem("token");if(t)try{const[a,n]=t.split("."),u=JSON.parse(atob(a)),o=atob(n),d=JSON.parse(atob(t.split(".")[1])),s=d.exp,i=new Date(s*1e3);console.log("Waktu Kedaluwarsa (UTC):",i.toUTCString()),new Date>i?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman"),this.user_id=d.id,console.log("ini idddd:",this.user_id),(!u||!o)&&this.$router.push("/"),this.fetchTrends()}catch(a){console.error("Error decoding token:",a),this.$router.push("/")}else this.$router.push("/")}},ye=Object.assign(ge,{__name:"GlobalTrends",setup(t){const a=m(!1),n=m(""),u=()=>{a.value=!a.value,n.value=a.value?"toggle-sidebar":""};return(o,d)=>(l(),r(b,null,[e("div",C,[h(y,{class:k(n.value)},null,8,["class"]),e("div",S,[e("div",A,[h(w,{onToggleSidebar:u}),e("div",U,[D,e("div",F,[I,e("div",N,[L,e("div",O,[o.ready?p("",!0):(l(),r("p",x,"Loading...")),o.ready?(l(),r("table",z,[J,e("tbody",null,[(l(!0),r(b,null,v(o.globalTrends,(s,i)=>(l(),r("tr",{key:s.id},[e("td",null,T(i+1),1),e("td",null,[e("button",{class:"btn btn-warning me-3","data-toggle":"modal","data-target":"#updateTrend",onClick:f=>o.setDataTrend(s.id,s.judul)},K,8,V),e("button",{class:"btn btn-danger",onClick:f=>o.konfirmasi(s.id,s.judul)},H,8,M)]),e("td",null,[e("img",{src:`https://backend-sblf.lumirainternational.com/storage/globalTrend/${s.image}`,alt:"trend",width:"200"},null,8,q)]),e("td",null,T(s.judul),1)]))),128))])])):p("",!0)])]),P])])]),h(j)])]),e("div",W,[e("div",Q,[e("div",R,[X,e("div",Y,[e("form",null,[e("div",Z,[ee,e("input",{type:"file",class:"form-control",id:"image",onChange:d[0]||(d[0]=(...s)=>o.handleFileUpload&&o.handleFileUpload(...s))},null,32)]),e("div",te,[ae,g(e("input",{type:"text",class:"form-control",id:"judul","onUpdate:modelValue":d[1]||(d[1]=s=>o.dataTrends.judul=s),placeholder:"Masukkan judul"},null,512),[[_,o.dataTrends.judul]])])])]),e("div",se,[oe,e("button",{type:"button",class:"btn blueButton",onClick:d[2]||(d[2]=(...s)=>o.tambahTrend&&o.tambahTrend(...s))}," Kirim ")])])])]),e("div",de,[e("div",ne,[e("div",le,[re,e("div",ie,[e("form",null,[e("div",ce,[ue,e("input",{type:"file",class:"form-control",id:"image",onChange:d[3]||(d[3]=(...s)=>o.handleFileUpload&&o.handleFileUpload(...s))},null,32)]),e("div",he,[me,g(e("input",{type:"text",class:"form-control",id:"judul","onUpdate:modelValue":d[4]||(d[4]=s=>o.dataUpdateTrends.judul=s),placeholder:"Masukkan judul"},null,512),[[_,o.dataUpdateTrends.judul]])])])]),e("div",pe,[be,e("button",{type:"button",class:"btn btn-primary",onClick:d[5]||(d[5]=(...s)=>o.updateTrend&&o.updateTrend(...s))}," Update ")])])])])],64))}});export{ye as default};
